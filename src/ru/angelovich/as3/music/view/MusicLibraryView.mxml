<?xml version="1.0"?>
<!--
  Created by angel777d on 31.05.2014.
-->
<s:TitleWindow xmlns:fx="http://ns.adobe.com/mxml/2009"
               xmlns:s="library://ns.adobe.com/flex/spark"
               creationComplete="creationCompleteHandler(event)"
               width="500" height="400"
               close="close(event)">

    <fx:Script>
        <![CDATA[
        import mx.events.FlexEvent;
        import mx.managers.PopUpManager;

        import ru.angelovich.as3.music.model.Model;
        import ru.angelovich.as3.music.model.MusicLibraryItem;

        import spark.events.IndexChangeEvent;

        private var _library:Object = {};

        private function scanHandler(event:MouseEvent):void {
            Model.instance.scanLibrary();
        }

        private function creationCompleteHandler(event:FlexEvent):void {
            Model.instance.loadLibrary();
        }

        private function close(event:Event):void {
            PopUpManager.removePopUp(this);
        }

        private function selectionChangeHandler(event:IndexChangeEvent):void {
            var item:MusicLibraryItem = event.target.dataProvider.getItemAt(event.newIndex) as MusicLibraryItem;
            if (item) Model.instance.currentItem = item;
        }
        ]]>
    </fx:Script>

    <s:layout>
        <s:VerticalLayout paddingLeft="10" paddingRight="10" paddingTop="5" paddingBottom="5" gap="5"/>
    </s:layout>

    <s:Button label="scan file system" click="scanHandler(event)"/>

    <s:List width="100%" height="100%" itemRenderer="ru.angelovich.as3.music.view.MusicLibraryItemRenderer"
            dataProvider="{Model.instance.allCollection}" change="selectionChangeHandler(event)">
        <s:layout>
            <s:VerticalLayout useVirtualLayout="true"/>
        </s:layout>
    </s:List>

</s:TitleWindow>
